<section class="get-inspired" data-section-id="{{ section.id }}" data-section-type="get-inspired">
  {% if section.settings.title != blank %}
    <h2 class="get-inspired-title">{{ section.settings.title }}</h2>
  {% endif %}
  
  {% if section.blocks.size > 0 %}
    <!-- Grid para Desktop y Tablet -->
    <div class="get-inspired-grid">
      {% for block in section.blocks %}
        <div class="inspired-item" {{ block.shopify_attributes }}>
          {% if block.settings.image != blank %}
            {% if block.settings.link_url != blank %}
              <a href="{{ block.settings.link_url }}" class="inspired-link">
                <img 
                  src="{{ block.settings.image | img_url: 'master' }}" 
                  alt="{{ block.settings.alt_text | default: block.settings.image.alt | escape }}"
                  loading="lazy"
                >
              </a>
            {% else %}
              <img 
                src="{{ block.settings.image | img_url: 'master' }}" 
                alt="{{ block.settings.alt_text | default: block.settings.image.alt | escape }}"
                loading="lazy"
              >
            {% endif %}
          {% else %}
            <div class="inspired-placeholder">
              <p>Agrega una imagen en este bloque</p>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>

    <!-- Carrusel para Mobile -->
    <div class="get-inspired-carousel" id="get-inspired-carousel-{{ section.id }}">
      {% for block in section.blocks %}
        <div class="inspired-item" {{ block.shopify_attributes }}>
          {% if block.settings.image != blank %}
            {% if block.settings.link_url != blank %}
              <a href="{{ block.settings.link_url }}" class="inspired-link">
                <img 
                  src="{{ block.settings.image | img_url: 'master' }}" 
                  alt="{{ block.settings.alt_text | default: block.settings.image.alt | escape }}"
                  loading="lazy"
                >
              </a>
            {% else %}
              <img 
                src="{{ block.settings.image | img_url: 'master' }}" 
                alt="{{ block.settings.alt_text | default: block.settings.image.alt | escape }}"
                loading="lazy"
              >
            {% endif %}
          {% else %}
            <div class="inspired-placeholder">
              <p>Agrega una imagen en este bloque</p>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="get-inspired-empty">
      <p>Agrega bloques de imagen desde el editor para mostrar contenido aquí.</p>
    </div>
  {% endif %}
</section>

<script>
  (function() {
    var sectionId = '{{ section.id }}';
    
    function initGetInspiredCarousel() {
      var carousel = document.getElementById('get-inspired-carousel-' + sectionId);
      
      if (!carousel) return;
      
      // Esperar a que jQuery y Slick estén disponibles
      if (typeof jQuery === 'undefined' || !jQuery.fn.slick) {
        setTimeout(initGetInspiredCarousel, 100);
        return;
      }
      
      var $carousel = jQuery(carousel);
      
      // Función para inicializar/destruir carrusel según el tamaño de pantalla
      function handleCarousel() {
        if (window.innerWidth <= 600) {
          // Mobile: inicializar carrusel
          if (!$carousel.hasClass('slick-initialized')) {
            $carousel.slick({
              dots: true,
              arrows: true,
              infinite: true,
              speed: 300,
              slidesToShow: 1,
              slidesToScroll: 1,
              adaptiveHeight: false,
              autoplay: false,
              fade: false,
              cssEase: 'ease',
              swipe: true,
              touchMove: true,
              draggable: true,
              touchThreshold: 5
            });
            
            // Asegurar que las imágenes sean clickeables
            $carousel.on('init', function() {
              $carousel.find('.inspired-item img').css({
                'pointer-events': 'auto',
                'cursor': 'pointer'
              });
            });
          }
        } else {
          // Desktop/Tablet: destruir carrusel si está inicializado
          if ($carousel.hasClass('slick-initialized')) {
            $carousel.slick('unslick');
          }
        }
      }
      
      // Inicializar al cargar
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(handleCarousel, 200);
        });
      } else {
        setTimeout(handleCarousel, 200);
      }
      
      // Manejar redimensionamiento
      var resizeTimer;
      window.addEventListener('resize', function() {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(handleCarousel, 250);
      });
    }
    
    // Iniciar
    initGetInspiredCarousel();
  })();
</script>

{% schema %}
{
  "name": "Get Inspired",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Título",
      "default": "GET INSPIRED"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Imagen",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Imagen"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Texto alternativo",
          "info": "Si se deja vacío, se usará el texto alternativo de la imagen"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "URL del enlace",
          "info": "Opcional: Agrega una URL para que la imagen sea clickeable (producto, colección, página, etc.)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Get Inspired",
      "category": "Homepage",
      "blocks": [
        {
          "type": "image"
        },
        {
          "type": "image"
        },
        {
          "type": "image"
        }
      ]
    }
  ]
}
{% endschema %}

