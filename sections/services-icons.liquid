<section
  class="custom-services"
  data-section-id="{{ section.id }}"
  data-section-type="services-icons"
>
  <!-- Grid para Desktop y Tablet -->
  <div class="services-container">
    {% if section.blocks.size > 0 %}
      {% for block in section.blocks %}
        <div class="service-item" {{ block.shopify_attributes }}>
          {% if block.settings.icon_svg != blank %}
            <div class="service-icon-wrapper" aria-hidden="true">
              {{ block.settings.icon_svg }}
            </div>
          {% endif %}

          {% if block.settings.title != blank %}
            <h3>{{ block.settings.title }}</h3>
          {% endif %}
        </div>
      {% endfor %}
    {% else %}
      <div class="service-item">
        <h3>Agrega bloques de servicio para mostrarlos aquí.</h3>
      </div>
    {% endif %}
  </div>

  <!-- Carrusel para Mobile -->
  <div class="services-carousel" id="services-carousel-{{ section.id }}">
    {% if section.blocks.size > 0 %}
      {% for block in section.blocks %}
        <div class="service-item" {{ block.shopify_attributes }}>
          {% if block.settings.icon_svg != blank %}
            <div class="service-icon-wrapper" aria-hidden="true">
              {{ block.settings.icon_svg }}
            </div>
          {% endif %}

          {% if block.settings.title != blank %}
            <h3>{{ block.settings.title }}</h3>
          {% endif %}
        </div>
      {% endfor %}
    {% endif %}
  </div>
</section>

<script>
  (function() {
    var sectionId = '{{ section.id }}';
    
    function initServicesCarousel() {
      var carousel = document.getElementById('services-carousel-' + sectionId);
      
      if (!carousel) return;
      
      // Esperar a que jQuery y Slick estén disponibles
      if (typeof jQuery === 'undefined' || !jQuery.fn.slick) {
        setTimeout(initServicesCarousel, 100);
        return;
      }
      
      var $carousel = jQuery(carousel);
      
      // Función para inicializar/destruir carrusel según el tamaño de pantalla
      function handleCarousel() {
        if (window.innerWidth <= 600) {
          // Mobile: inicializar carrusel con autoplay
          if (!$carousel.hasClass('slick-initialized')) {
            $carousel.slick({
              dots: false,
              arrows: false,
              infinite: true,
              speed: 800,
              slidesToShow: 1,
              slidesToScroll: 1,
              autoplay: true,
              autoplaySpeed: 3000,
              fade: false,
              cssEase: 'ease-in-out',
              pauseOnHover: false,
              pauseOnFocus: false,
              swipe: true,
              touchMove: true
            });
          }
        } else {
          // Desktop/Tablet: destruir carrusel si está inicializado
          if ($carousel.hasClass('slick-initialized')) {
            $carousel.slick('unslick');
          }
        }
      }
      
      // Inicializar al cargar
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(handleCarousel, 200);
        });
      } else {
        setTimeout(handleCarousel, 200);
      }
      
      // Manejar redimensionamiento
      var resizeTimer;
      window.addEventListener('resize', function() {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(handleCarousel, 250);
      });
    }
    
    // Iniciar
    initServicesCarousel();
  })();
</script>

{% schema %}
{
  "name": "Services Icons",
  "settings": [],
  "blocks": [
    {
      "type": "service",
      "name": "Servicio",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Título",
          "default": "WORLDWIDE SHIPPING"
        },
        {
          "type": "textarea",
          "id": "icon_svg",
          "label": "Icono SVG",
          "info": "Pega SVG optimizado. Debe incluir la clase 'service-icon' para mantener estilos.",
          "default": "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 126.56 87.07\" class=\"service-icon\"><circle cx=\"32.29\" cy=\"74.86\" r=\"10.71\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><circle cx=\"97.79\" cy=\"74.86\" r=\"10.71\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><polyline points=\"98.04 27.28 125.06 38.93 125.06 76.05\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><path d=\"M22.35,76.05c-12.75,0-20.85-8.29-20.85-18.53V1.5h76.82c10.89,0,19.72,7.09,19.72,15.83v35.71\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><line x1=\"64.41\" y1=\"76.05\" x2=\"42.93\" y2=\"76.05\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/></svg>"
        }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Services Icons",
      "category": "Homepage",
      "blocks": [
        {
          "type": "service",
          "settings": {
            "title": "WORLDWIDE SHIPPING",
            "icon_svg": "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 126.56 87.07\" class=\"service-icon\"><circle cx=\"32.29\" cy=\"74.86\" r=\"10.71\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><circle cx=\"97.79\" cy=\"74.86\" r=\"10.71\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><polyline points=\"98.04 27.28 125.06 38.93 125.06 76.05\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><path d=\"M22.35,76.05c-12.75,0-20.85-8.29-20.85-18.53V1.5h76.82c10.89,0,19.72,7.09,19.72,15.83v35.71\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/><line x1=\"64.41\" y1=\"76.05\" x2=\"42.93\" y2=\"76.05\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\"/></svg>"
          }
        },
        {
          "type": "service",
          "settings": {
            "title": "VISIT OUR SHOWROOM",
            "icon_svg": "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\" class=\"service-icon\"><path d=\"M50 5a30 30 0 0 0-30 30c0 20 30 60 30 60s30-40 30-60A30 30 0 0 0 50 5zm0 43a13 13 0 1 1 13-13 13 13 0 0 1-13 13z\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" /></svg>"
          }
        },
        {
          "type": "service",
          "settings": {
            "title": "CUSTOMER SERVICE",
            "icon_svg": "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 117.31 105.3\" class=\"service-icon\"><path d=\"M77.06,1.5H1.5v53.68c0,5.76,4.67,10.43,10.43,10.43h3.34c1.68,0,3.05,1.36,3.05,3.05v21.07c0,.26.3.39.49.23l27.82-23.62c.55-.47,1.25-.72,1.97-.72h34.43c5.76,0,10.43-4.67,10.43-10.43V17.91c0-9.06-7.35-16.41-16.41-16.41Z\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\" /><path d=\"M115.81,25.7v43.25c0,5.76-4.67,10.43-10.43,10.43h-3.34c-1.68,0-3.05,1.36-3.05,3.05v21.07c0,.26-.3.39-.49.23l-27.82-23.62c-.55-.47-1.25-.72-1.97-.72h-22.79\" fill=\"none\" stroke=\"#231f20\" stroke-width=\"3\" stroke-miterlimit=\"10\" /></svg>"
          }
        }
      ]
    }
  ]
}
{% endschema %}

